# Kaplay.js 测试目录说明文档

## 测试目录结构概述

这个目录包含了Kaplay.js游戏引擎的所有测试文件。测试是确保我们的游戏引擎可靠工作的重要保障，就像是给汽车做定期检查一样。

## 目录结构

### `/tests/auto/` - 自动化单元测试

这个目录包含自动运行的测试，用于检验引擎各个部分是否正常工作：

- `color.spec.ts` - 测试颜色处理功能
  - 确保颜色转换(如RGB到HSL)正确工作
  - 测试颜色混合、渐变等函数

- `kaplay.spec.ts` - 核心引擎功能测试
  - 测试引擎初始化和配置是否正常
  - 验证核心API的功能

- `missingComps.spec.ts` - 缺失组件处理测试
  - 检查当游戏对象缺少必要组件时的错误处理
  - 验证组件依赖关系的检查逻辑

- `plugin.spec.ts` - 插件系统测试
  - 测试插件安装和卸载流程
  - 检验插件钩子和API扩展功能

- `vec2.spec.ts` - 二维向量功能测试
  - 向量数学运算(加、减、缩放等)测试
  - 向量特殊操作(归一化、点积、叉积等)测试

### `/tests/playtests/` - 游戏场景测试

这个目录包含更复杂的测试，模拟真实游戏场景：

- 完整游戏功能的集成测试
- 性能测试和基准测试
- 用户交互模拟测试

### `/tests/types/` - 类型系统测试

这个目录专门用于测试TypeScript类型定义的正确性：

- 测试API类型定义是否准确
- 检查类型推断是否如预期工作
- 验证类型错误是否被正确捕获

### 其他文件

- `tsconfig.json` - 测试代码的TypeScript配置
  - 设置了严格的类型检查规则
  - 配置了测试环境的模块解析策略
  - 指定了测试需要的类型定义

- `.env.d.ts` - 环境变量的类型定义
  - 定义了测试环境中可用的全局变量类型

## 如何运行测试

Kaplay.js使用Vitest和Puppeteer进行测试。测试可以通过以下命令运行：

```bash
pnpm test        # 运行所有测试
pnpm test:unit   # 只运行单元测试
```

## 测试编写指南

编写新测试时，请遵循以下原则：

1. 每个测试应该专注于一个功能或一个bug
2. 使用描述性的测试名称，清楚表明测试的目的
3. 设置尽可能少的测试前提条件
4. 编写清晰的断言，表明期望的结果
5. 测试边界条件和错误情况

小朋友理解版：测试就像是给游戏做体检，确保它的每个部分都健康工作。自动测试就像是智能机器人，能自动检查游戏的各种功能是否正常运转！
